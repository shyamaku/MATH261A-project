library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste0(week, "_", as.numeric(`Incident Year`))) %>%
count(week_year, name = 'num_theft')
head(vehicle_data)
#pol_lmfit <- lm(`Incident Category` ~ week, data = vehicle_data)
#summary(pol_lmfit)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste0(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- as.data.frame(vehicle_data$week_year, count(week_year, name = 'num_theft'))
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- as.data.frame(vehicle_data$week_year, count(week_year, name = 'num_theft'))
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- as.data.frame(vehicle_data$week_year, count(vehicle_data$week_year, name = 'num_theft'))
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(vehicle_data)
#pol_lmfit <- lm(`Incident Category` ~ week, data = vehicle_data)
#summary(pol_lmfit)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(theft_per_week)
#pol_lmfit <- lm(`Incident Category` ~ week, data = vehicle_data)
#summary(pol_lmfit)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
#pol_lmfit <- lm(`Incident Category` ~ week, data = vehicle_data)
#summary(pol_lmfit)
View(vehicle_data)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(week_year, num_theft)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(theft_per_week$week_year, theft_per_week$num_theft)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week_year, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(factor(theft_per_week$week_year), theft_per_week$num_theft)
pol_lmfit <- lm(num_theft ~ week_year, data = theft_per_week)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(factor(theft_per_week$week_year), theft_per_week$num_theft)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(theft_per_week$week, theft_per_week$num_theft)
pol_lmfit <- lm(num_theft ~ week_year, data = theft_per_week)
library(dplyr)
library(ggplot2)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
#head(vehicle_data)
print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week <- vehicle_data %>% count(week, name = 'num_theft')
head(theft_per_week)
print(factor(theft_per_week$week_year))
plot(theft_per_week$week, theft_per_week$num_theft)
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`=2020)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020)
vehicle_data_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021)
vehicle_data_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022)
vehicle_data_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023)
vehicle_data_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024)
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`=2020) %>% count(week, name = 'num_theft')
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020)
vehicle_data_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021)
vehicle_data_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022)
vehicle_data_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023)
vehicle_data_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024)
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
head(theft_per_week_2020)
print(factor(theft_per_week$week_year))
plot(theft_per_week$week, theft_per_week$num_theft)
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020)
vehicle_data_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021)
vehicle_data_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022)
vehicle_data_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023)
vehicle_data_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024)
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(week = theft_per_week_2020$week, num_theft = theft_per_week_2020$num_theft)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020)
vehicle_data_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021)
vehicle_data_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022)
vehicle_data_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023)
vehicle_data_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024)
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p1
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2020)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
vehicle_data_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020)
vehicle_data_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021)
vehicle_data_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022)
vehicle_data_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023)
vehicle_data_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024)
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
print(p1)
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2020)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p2 <- plot(theft_per_week_2021$week, theft_per_week_2021$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2021")
p3 <- plot(theft_per_week_2022$week, theft_per_week_2022$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2022")
p4 <- plot(theft_per_week_2023$week, theft_per_week_2023$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2023")
p5 <- plot(theft_per_week_2024$week, theft_per_week_2024$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2024")
print(p1|p2)
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2020)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p2 <- plot(theft_per_week_2021$week, theft_per_week_2021$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2021")
p3 <- plot(theft_per_week_2022$week, theft_per_week_2022$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2022")
p4 <- plot(theft_per_week_2023$week, theft_per_week_2023$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2023")
p5 <- plot(theft_per_week_2024$week, theft_per_week_2024$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2024")
print(p1|p2|p3|p4|p5)
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2020)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p2 <- plot(theft_per_week_2021$week, theft_per_week_2021$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2021")
p3 <- plot(theft_per_week_2022$week, theft_per_week_2022$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2022")
p4 <- plot(theft_per_week_2023$week, theft_per_week_2023$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2023")
p5 <- plot(theft_per_week_2024$week, theft_per_week_2024$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2024")
p1|p2|p3|p4|p5
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2020)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p2 <- plot(theft_per_week_2021$week, theft_per_week_2021$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2021")
p3 <- plot(theft_per_week_2022$week, theft_per_week_2022$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2022")
p4 <- plot(theft_per_week_2023$week, theft_per_week_2023$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2023")
p5 <- plot(theft_per_week_2024$week, theft_per_week_2024$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2024")
p1|p2|p3|p4|p5
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2021)
summary(pol_lmfit)
library(dplyr)
library(ggplot2)
library(patchwork)
#police_incidents <- readr::read_csv('C:/Users/shyam/OneDrive/Desktop/MATH261A/Police_Department_Incident_Reports__2018_to_Present_20250922.csv')
#head(police_incidents)
#unique(police_incidents$`Incident Category`)
vehicle_data <- subset(police_incidents, police_incidents$`Incident Category` == "Motor Vehicle Theft")
incident_week <- as.Date(vehicle_data$`Incident Date`, format="%Y-%m-%d")
vehicle_data$week <- as.numeric(strftime(incident_week, format="%V"))
#head(vehicle_data)
#print(sum(is.na(as.numeric(vehicle_data$`Incident Category`))))
#vehicle_data <- vehicle_data %>% mutate(week_year = paste(week, "_", as.numeric(`Incident Year`)))
theft_per_week_2020 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2020) %>% count(week, name = 'num_theft')
theft_per_week_2021 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2021) %>% count(week, name = 'num_theft')
theft_per_week_2022 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2022) %>% count(week, name = 'num_theft')
theft_per_week_2023 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2023) %>% count(week, name = 'num_theft')
theft_per_week_2024 <- subset(vehicle_data, vehicle_data$`Incident Year`== 2024) %>% count(week, name = 'num_theft')
#head(theft_per_week_2020)
p1 <- plot(theft_per_week_2020$week, theft_per_week_2020$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2020")
p2 <- plot(theft_per_week_2021$week, theft_per_week_2021$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2021")
p3 <- plot(theft_per_week_2022$week, theft_per_week_2022$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2022")
p4 <- plot(theft_per_week_2023$week, theft_per_week_2023$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2023")
p5 <- plot(theft_per_week_2024$week, theft_per_week_2024$num_theft, xlab = "Week", ylab = "Number of Thefts", main = "Vehicle Thefts per Week in 2024")
p1|p2|p3|p4|p5
pol_lmfit <- lm(num_theft ~ week, data = theft_per_week_2024)
summary(pol_lmfit)
# Add diagonal reference line
abline(0, 1, lty = 2, col = "gray")
library(ggplot2)
TPR = [1.0, 1.0, 0.8, 0.8, 0.8, 0.6, 0.6, 0.4, 0.2, 0.2, 0.0]
library(ggplot2)
# Your data
TPR <- c(1.0, 1.0, 0.8, 0.8, 0.8, 0.6, 0.6, 0.4, 0.2, 0.2, 0.0)
FPR <- c(1.0, 0.8, 0.8, 0.6, 0.4, 0.4, 0.2, 0.2, 0.2, 0.0, 0.0)
# Plot ROC curve
plot(FPR, TPR, type = "o", col = "blue", lwd = 2, pch = 16,
xlab = "False Positive Rate (FPR)",
ylab = "True Positive Rate (TPR)",
main = "ROC Curve")
# Add diagonal reference line
abline(0, 1, lty = 2, col = "gray")
library(ggplot2)
# Your data
TPR <- c(1.0, 1.0, 0.8, 0.8, 0.8, 0.6, 0.6, 0.4, 0.2, 0.2, 0.0)
FPR <- c(1.0, 0.8, 0.8, 0.6, 0.4, 0.4, 0.2, 0.2, 0.2, 0.0, 0.0)
# Plot ROC curve
plot(FPR, TPR, type = "o", col = "blue", lwd = 2, pch = 16,
xlab = "FPR",
ylab = "TPR",
main = "ROC Curve")
# Your data
Recall<- c(1.0, 1.0, 0.8, 0.8, 0.8, 0.6, 0.6, 0.4, 0.2, 0.2, 0.0)
Precision <- c(0.5, 0.56, 0.5, 0.57, 0.67, 0.6, 0.75, 0.67, 0.5, 1.0, 1.0)
# Plot ROC curve
plot(Recall, Precision, type = "o", col = "black", lwd = 2, pch = 16,
xlab = "recall",
ylab = "precision",
main = "PR Curve")
# Your data
Recall<- c(1.0, 1.0, 0.8, 0.8, 0.8, 0.6, 0.6, 0.4, 0.2, 0.2, 0.0)
Precision <- c(0.5, 0.56, 0.5, 0.57, 0.67, 0.6, 0.75, 0.67, 0.5, 1.0, 1.0)
# Plot ROC curve
plot(Recall, Precision, type = "o", col = "black", lwd = 2, pch = 16,
xlab = "recall", ylab = "precision", main = "PR Curve",
xlim = c(0, 1), ylim = c(0, 1), yaxs = "i", xaxs = "i", yaxt = "n")
# Plot ROC curve
plot(Recall, Precision, type = "o", col = "red", lwd = 2, pch = 16,
xlab = "recall", ylab = "precision", main = "PR Curve",
xlim = c(0, 1), ylim = c(0, 1), yaxs = "i", xaxs = "i", yaxt = "n")
plot(FPR, TPR, type = "o", col = "blue", lwd = 2, pch = 16,
xlab = "FPR",
ylab = "TPR",
main = "ROC Curve")
# Plot ROC curve
plot(Recall, Precision, type = "o", col = "red", lwd = 2, pch = 16,
xlab = "recall", ylab = "precision", main = "PR Curve",
xlim = c(0, 1), ylim = c(0, 1), yaxs = "i", xaxs = "i", yaxt = "n")
#modified ROC:
TPR_m <- c(1.0, 1.0, 1.0, 1.0, 0.8, 0.8, 0.6, 0.4, 0.4, 0.2, 0.0)
FPR_m <- c(1.0, 0.8, 0.6, 0.4, 0.4, 0.2, 0.2, 0.2, 0.0, 0.0, 0.0)
#modifies PR:
Recall_m<- c(1.0, 1.0, 1.0, 1.0, 0.8, 0.8, 0.6, 0.4, 0.4, 0.2, 0.0)
Precision_m <- c(0.5, 0.56, 0.625, 0.714, 0.67, 0.8, 0.75, 0.67, 1.0, 1.0, 1.0)
# Plot PR curve
plot(Recall_m, Precision_m, type = "o", col = "red", lwd = 2, pch = 16,
xlab = "recall", ylab = "precision", main = "PR Curve",
xlim = c(0, 1), ylim = c(0, 1), yaxs = "i", xaxs = "i", yaxt = "n")
